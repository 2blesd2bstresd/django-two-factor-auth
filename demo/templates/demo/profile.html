{% extends "base.html" %}
{% load future %}

{% block title %}My Profile{% endblock %}
{% block nav_profile %}active{% endblock %}

{% block content %}
    <h1>My Profile</h1>

    <dl>
        <dt>Logged in as</dt>
        <dd>{{ user }} (<a href="{% url 'logout' %}">Logout</a>)</dd>

        <dt>Two-factor authentication</dt>
        <dd>
            {% if user.token %}
                Enabled (<a href="{% url 'tf:disable' %}">Disable two-factor
                authentication</a>)
            {% else %}
                Disabled (<a href="{% url 'tf:enable' %}">Enable two-factor
                authentication</a>)
            {% endif %}
        </dd>
    </dl>

    <h4>Authorized Computers</h4>
    {% if user.verifiedcomputer_set.all %}
        <table class="table table-striped table-bordered">
            <thead><tr><th>IP Address</th>
                <th>Last Used</th>
                <th>Actions</th></tr></thead>
        {% for vc in user.verifiedcomputer_set.all %}
            <tr><td>{{ vc.ip }}</td>
                <td>{{ vc.last_used_at|timesince }} ago</td>
                <td><form action="{% url 'unverify' vc.id %}" method="post">
                    {% csrf_token %}
                    <button class="btn btn-small btn-warning">Delete</button>
                </form></td>
            </tr>
        {% endfor %}
        </table>
    {% else %}
        <p>No verified computers</p>
    {% endif %}

{% endblock %}
